# Thermal efficiency optimization configuration
# This configuration focuses on thermal efficiency optimization for acceleration zones

# Engine geometry parameters
geometry:
  bore: 0.082  # m - Engine bore diameter
  stroke: 0.180  # m - Engine stroke
  compression_ratio: 12.0  # Compression ratio
  clearance_volume: 3.2e-5  # m^3 - Clearance volume
  mass: 1.0  # kg - Piston mass
  rod_mass: 0.5  # kg - Connecting rod mass
  rod_length: 0.15  # m - Connecting rod length
  rod_cg_offset: 0.075  # m - Rod center of gravity offset
  friction_coefficient: 0.1  # Friction coefficient
  damping_coefficient: 100.0  # Ns/m - Damping coefficient
  ring_count: 3  # Number of piston rings
  ring_tension: 100.0  # N - Ring tension
  ring_width: 0.002  # m - Ring width
  ring_friction_coefficient: 0.1  # Ring friction coefficient
  T_wall: 400.0  # K - Wall temperature
  p_intake: 1e5  # Pa - Intake pressure
  T_intake: 300.0  # K - Intake temperature
  p_exhaust: 1e5  # Pa - Exhaust pressure

# Thermodynamics parameters
thermodynamics:
  gamma: 1.34  # Heat capacity ratio
  R: 287.0  # J/(kg K) - Gas constant
  cp: 1005.0  # J/(kg K) - Specific heat at constant pressure
  cv: 717.5  # J/(kg K) - Specific heat at constant volume

# Optimization bounds and constraints
bounds:
  # Piston position bounds
  xL_min: -0.1  # m - Left piston minimum position
  xL_max: 0.1   # m - Left piston maximum position
  xR_min: 0.0   # m - Right piston minimum position
  xR_max: 0.2   # m - Right piston maximum position
  
  # Piston velocity bounds
  vL_min: -50.0  # m/s - Left piston minimum velocity
  vL_max: 50.0   # m/s - Left piston maximum velocity
  vR_min: -50.0  # m/s - Right piston minimum velocity
  vR_max: 50.0   # m/s - Right piston maximum velocity
  
  # Gas state bounds
  rho_min: 0.1   # kg/m^3 - Minimum gas density
  rho_max: 10.0  # kg/m^3 - Maximum gas density
  T_min: 200.0   # K - Minimum gas temperature
  T_max: 2600.0  # K - Maximum gas temperature
  p_min: 1e4     # Pa - Minimum gas pressure
  p_max: 12e6    # Pa - Maximum gas pressure
  
  # Valve area bounds
  Ain_max: 0.01  # m^2 - Maximum intake valve area
  Aex_max: 0.01  # m^2 - Maximum exhaust valve area
  
  # Other bounds
  Q_comb_max: 10000.0  # J - Maximum combustion heat release
  dA_dt_max: 0.02      # m^2/s - Maximum valve area rate
  a_max: 1000.0        # m/s^2 - Maximum acceleration
  x_gap_min: 0.0008    # m - Minimum piston gap

# Optimization constraints
constraints:
  short_circuit_max: 0.1    # Maximum short-circuit loss
  scavenging_min: 0.8       # Minimum scavenging efficiency
  trapping_min: 0.9         # Minimum trapping efficiency

# Numerical parameters
num:
  K: 30  # Number of collocation points
  C: 3   # Collocation degree

# Solver settings
solver:
  ipopt:
    max_iter: 1000                    # Maximum iterations
    tol: 1e-6                        # Tolerance
    linear_solver: ma57              # Linear solver
    hessian_approximation: limited-memory  # Hessian approximation
    mu_strategy: adaptive            # Barrier parameter strategy
    mu_init: 1e-3                   # Initial barrier parameter
    print_level: 5                  # Print level
    print_timing_statistics: yes    # Print timing statistics
    print_user_options: no          # Print user options

# Objective function configuration
objective:
  method: thermal_efficiency  # Objective method
  w:
    smooth: 0.01              # Smoothness weight
    short_circuit: 2.0        # Short-circuit penalty weight
    eta_th: 1.0              # Thermal efficiency weight

# Model configuration
model_type: 1d               # Model type: "0d" or "1d"
use_1d_gas: true            # Use 1D gas model
n_cells: 50                 # Number of 1D cells

# Validation settings
validation:
  check_convergence: true           # Check convergence
  check_physics: true              # Check physics constraints
  check_constraints: true          # Check optimization constraints
  thermal_efficiency_min: 0.3     # Minimum thermal efficiency
  max_pressure_limit: 12e6        # Pa - Maximum pressure limit
  max_temperature_limit: 2600.0   # K - Maximum temperature limit
  min_piston_gap_limit: 0.0008    # m - Minimum piston gap limit

# Output settings
output:
  save_solution: true              # Save optimization solution
  save_metrics: true              # Save performance metrics
  generate_report: true           # Generate optimization report
  save_plots: true               # Save visualization plots
  plot_format: png               # Plot format: png, pdf, svg

# Advanced options
warm_start:
  enabled: false                 # Enable warm start
  x0_file: null                 # Initial guess file

# Refinement strategy
refinement_strategy: adaptive    # Refinement strategy
max_refinements: 3              # Maximum number of refinements

# Performance settings
performance:
  parallel_processing: false     # Enable parallel processing
  memory_limit: 2e9            # Memory limit in bytes
  cpu_time_limit: 300          # CPU time limit in seconds

# Thermal efficiency specific settings
thermal_efficiency:
  # Focus on acceleration zones
  acceleration_zone_weight: 1.0   # Weight for acceleration zones
  deceleration_zone_weight: 0.5   # Weight for deceleration zones
  
  # Heat transfer optimization
  heat_transfer_weight: 0.8      # Weight for heat transfer optimization
  wall_heat_loss_weight: 0.2     # Weight for wall heat loss
  
  # Combustion optimization
  combustion_efficiency_weight: 1.0  # Weight for combustion efficiency
  ignition_timing_weight: 0.5        # Weight for ignition timing
  
  # Scavenging optimization
  scavenging_efficiency_weight: 1.0  # Weight for scavenging efficiency
  trapping_efficiency_weight: 0.8    # Weight for trapping efficiency
  blowdown_efficiency_weight: 0.6    # Weight for blowdown efficiency

# Engine type specific settings
engine_type: opposed_piston      # Engine type: opposed_piston, free_piston, conventional

# Operating conditions
operating_conditions:
  speed: 1500                   # RPM - Engine speed
  load: 0.8                    # Load factor (0-1)
  ambient_temperature: 300.0   # K - Ambient temperature
  ambient_pressure: 1e5        # Pa - Ambient pressure
  fuel_type: diesel            # Fuel type: diesel, gasoline, natural_gas
  air_fuel_ratio: 18.0         # Air-fuel ratio

# Optimization targets
targets:
  thermal_efficiency_target: 0.45    # Target thermal efficiency
  power_target: 50.0                 # kW - Target power output
  emissions_target: 0.5              # g/kWh - Target emissions
  fuel_consumption_target: 200.0     # g/kWh - Target fuel consumption

# Monitoring and logging
monitoring:
  log_level: INFO              # Log level: DEBUG, INFO, WARNING, ERROR
  log_file: thermal_efficiency_optimization.log  # Log file name
  progress_interval: 10        # Progress reporting interval (iterations)
  checkpoint_interval: 100     # Checkpoint saving interval (iterations)
  save_intermediate_results: true  # Save intermediate results
